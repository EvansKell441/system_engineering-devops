#!/usr/bin/env bash
# Simulates both 7-highlander (infinite loop) and 67-stop_me_if_you_can (sending SIGTERM)

trap 'echo "I am invincible!!!"' SIGTERM

while true; do
    echo "To infinity and beyond"
    sleep 2
done &
HIGHLANDER_PID=$!

sleep 3

for i in 1 2 3; do
    kill -TERM $HIGHLANDER_PID
    sleep 2
done

sleep 4

kill -INT $HIGHLANDER_PID
wait $HIGHLANDER_PID 2>/dev/null
echo "Simulation finished."
